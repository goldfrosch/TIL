# 프록시 패턴과 프록시 서버

## 프록시 패턴

프록시 패턴은 대상 객체에 접근하기 전 그 접근에 대한 흐름을 가로채 해당 접근을 필터링 or 수정하는 역할을 하는 계층이 있는 디자인 패턴이다.

이 방법을 사용해 객체의 속성, 변환 등을 보완하면서 보안, 데이터 검증, 캐싱, 로깅에도 주로 사용하게 된다.
이 패턴은 프록시 객체로 쓰이기도 하나 프록시 서버로도 활용이 된다.

### 프록시 서버 캐싱의 장점

캐시 안에 정보를 담아두고, 캐시 안의 정보를 요구하는 요청을 메인 서버가 아닌 프록시 서버로 요청해 캐시 안에 있는 데이터를 활용하는 것이 프록시 서버 캐싱의 원리다. 불필요하게 메인 서버를 연결하지 않고 외부 서버를 통해 캐싱을 가져옴으로써 메인 서버의 부담(트래픽)을 줄이는 장점이 있다.

## 프록시 서버

프록시 서버는 서버와 클라이언트 사이에서 클라이언트가 자신을 통해 다른 네트워크 서비스에 간접적으로 접속할 수 있게 해주는 컴퓨터 시스템 or 응용 프로그램을 가리킨다.

### Ngnix

Nginx가 프록시 서버의 가장 대표적인 예시이다.

nginx는 비동기 이벤트 기반의 구조와 다수 연결을 효과적으로 처리 가능한 웹 서버이며, 주로 서버 앞단의 프록시 서버로도 많이 활용한다.

#### Nginx 특징

- Reverse Proxy

  리버스 프록시란 외부에 노출시키려는 리소스 앞단에 위치한다.

  포워드 프록시 형태는 클라이언트 -> 프록시 -> 인터넷 -> 서버라면
  리버스 프록시는 클라이언트 -> 인터넷 -> 프록시 -> 서버 형태로 진행이 된다.

  예전에 다닌 회사 (W사)의 C어플은 AWS 이전 전에 Nginx를 열고 닫음으로써 WAS에 접근을 할 수 있게 만들었다.

  그때는 JSP였기 때문에 클라이언트 단계를 건너 뛰었지만 인터넷 -> 프록시 -> 서버 형태로 접근이 가능했음.

- 무중단 배포
  리버스 프록시를 통해 환경을 구축하여 무중단 배포 자동화를 구현이 가능하다.

  W사 어플의 경우 AWS 이전에는 수동 무중단 배포를 진행할 때 여러개의 물리서버를 1/N처리해 닫고 여는 방식을 함으로써
  NGINX에서 열린 서버들만 대상으로 분산으로 운영하게 해 무중단 배포가 가능했다.

- 로드밸런싱
  서버 부담의 부하를 줄이기 위해 서버의 성능을 올리는 scale-up, 서버의 물리, 논리 서버를 여러개 둬 분산하는 scale-out 시스템을 구현이 가능하다. 위의 W사 앱 설명에 같이 포함되는 내용이다. scale-out이 구현되어 있었는듯 하다.

### 클라이언트 프록시

webpack, vite같은 모듈번들러에서도 환경 설정에 proxy 설정이 가능하다. (주로 로컬에서 사용했었음)
프론트에서는 localhost:3001, 백엔드는 외부 도메인 서버 test.test.com:9007이라면 CORS가 발생하는데 프록시를 활용해 프론트 서버에서 요청되는 오리진을 test.test.com:9007로 변경해 사용하는 방식이다.

특정 path를 다른 서버 path기준으로 요청시킴으로써 CORS에러 해결과 다양한 서버의 통신도 원활하게 처리할 수 있었다.
